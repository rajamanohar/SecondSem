(function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankView,ref;return MyRankView=function(superClass){function MyRankView(){return MyRankView.__super__.constructor.apply(this,arguments)}return extend(MyRankView,superClass),MyRankView.prototype.template="my-rank",MyRankView.prototype.className="my-rank-view",MyRankView.prototype.events={"click .login-link":"showLoginDialog","click .myrank-row":"navigateToRoute","click .toggleExpand":"toggleExpand","click .nav-tab-link":"changeTab","mouseenter .lg-item":"mouseEnterListItem","mouseleave .lg-item":"mouseLeave","mouseenter .myrank-row":"mouseEnterTableRow","mouseleave .myrank-row":"mouseLeave"},MyRankView.prototype.initialize=function(options){return null==options&&(options={}),this.hacker=options.profile,this.listenTo(this.hacker,"reset",this.render),this.listenTo(this.hacker,"change",this.render),this.activeTab=options.activeTab||"domains",this.canRender=!0},MyRankView.prototype.render=function(){return this.hacker.sync_status&&this.canRender?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,activeTab:this.activeTab})),this.hacker.isLoggedIn()&&this.renderSubViews(),this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(64)),this},MyRankView.prototype.renderSubViews=function(){return"domains"===this.activeTab?(this.domains_view||(this.domains_view=new HR.MyRankDomainsView({hacker:this.hacker}),this.add_subview(this.domains_view)),this.assign("#domains",this.domains_view)):"contests"===this.activeTab?(this.contests_view||(this.contests_view=new HR.MyRankContestsView({hacker:this.hacker}),this.add_subview(this.contests_view)),this.assign("#contests",this.contests_view)):void 0},MyRankView.prototype.destroySubviews=function(){var views;return views=["domains_view","contests_view"],_.each(views,function(view){return this[view]?(this[view].destroy(),this[view]=void 0):void 0},this)},MyRankView.prototype.showLoginDialog=function(){var dialog;return dialog=HR.util.ShowLoginDialog({error_message:"Please sign up or log in to see your my rank page.",show_sign_up_link:!0}),dialog.render()},MyRankView.prototype.navigateToRoute=function(e){var current_target,href;return current_target=$(e.currentTarget),href=current_target.data("href"),href&&HR.router.navigate(href,{trigger:!0,replace:!0}),this.trackClick(current_target)},MyRankView.prototype.toggleExpand=function(e){var action,elem;return elem=$(e.currentTarget),action="Expand",elem.hasClass("icon-down-open")?($("#"+elem.data("expand-id")).hide(),elem.removeClass("icon-down-open"),elem.addClass("icon-right-open"),action="Collapse"):elem.hasClass("icon-right-open")&&($("#"+elem.data("expand-id")).show(),elem.removeClass("icon-right-open"),elem.addClass("icon-down-open")),hr_metrics.track("Click",elem.data("analytics-val"),{attribute1:action,attribute7:elem.data("attr7")})},MyRankView.prototype.changeTab=function(e){var new_tab;return e.preventDefault(),new_tab=$(e.currentTarget).data("content-id"),new_tab?(HR.router.navigate("/rank/"+new_tab,!1),this.activeTab=new_tab,this.renderSubViews()):void 0},MyRankView.prototype.mouseEnterListItem=function(e){var current_target;return current_target=$(e.currentTarget),current_target.data("mouseHovered",!0),setTimeout(function(_this){return function(){return _this.trackHover(e,"MyRankBadgeRecommendedChallenge")}}(this),300)},MyRankView.prototype.mouseLeave=function(e){return $(e.currentTarget).data("mouseHovered",!1)},MyRankView.prototype.mouseEnterTableRow=function(e){var current_target,event_value;return current_target=$(e.currentTarget),current_target.data("mouseHovered",!0),event_value=current_target.data("analytics-val")||"MyRankTableRow",setTimeout(function(_this){return function(){return _this.trackHover(e,event_value)}}(this),300)},MyRankView.prototype.trackHover=function(e,event_value){var attrs,current_target;return current_target=$(e.currentTarget),current_target.data("mouseHovered")===!0?(attrs=this.trackAttributes(current_target),hr_metrics.track("Hover",event_value,attrs)):void 0},MyRankView.prototype.trackClick=function(current_target){var attrs;return attrs=this.trackAttributes(current_target),current_target.data("analytics-val")?hr_metrics.track("Click",current_target.data("analytics-val"),attrs):void 0},MyRankView.prototype.trackAttributes=function(current_target){var _i,attrs;for(attrs={},_i=1;11>=_i;)current_target.data("attr"+_i)&&(attrs["attribute"+_i]=current_target.data("attr"+_i)),_i++;return attrs},MyRankView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankView=MyRankView})}).call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankDomainsView,ref;return MyRankDomainsView=function(superClass){function MyRankDomainsView(){return MyRankDomainsView.__super__.constructor.apply(this,arguments)}return extend(MyRankDomainsView,superClass),MyRankDomainsView.prototype.template="my-rank-domains",MyRankDomainsView.prototype.className="my-rank-domains-view",MyRankDomainsView.prototype.initialize=function(options){return null==options&&(options={}),this.hacker=options.hacker},MyRankDomainsView.prototype.render=function(){return $(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker})),this.renderSubViews(),this.delegateEvents(),this},MyRankDomainsView.prototype.renderSubViews=function(){return this.badges_view||(this.badges_view=new HR.MyRankDomainsBadgesView({hacker:this.hacker}),this.add_subview(this.badges_view)),this.assign("#badge-container-block",this.badges_view),this.recent_activity_view||(this.recent_activity_view=new HR.MyRankDomainsRecentActivityView({hacker:this.hacker}),this.add_subview(this.recent_activity_view)),this.assign("#recent-activity-block",this.recent_activity_view)},MyRankDomainsView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankDomainsView=MyRankDomainsView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankContestsView,ref;return MyRankContestsView=function(superClass){function MyRankContestsView(){return MyRankContestsView.__super__.constructor.apply(this,arguments)}return extend(MyRankContestsView,superClass),MyRankContestsView.prototype.template="my-rank-contests",MyRankContestsView.prototype.className="my-rank-contests-view",MyRankContestsView.prototype.initialize=function(options){return null==options&&(options={}),this.hacker=options.hacker},MyRankContestsView.prototype.render=function(){return $(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker})),this.renderSubViews(),this.delegateEvents(),this},MyRankContestsView.prototype.renderSubViews=function(){return this.recent_contests_view||(this.recent_contests_view=new HR.MyRankRecentContestsView({hacker:this.hacker}),this.add_subview(this.recent_contests_view)),this.assign("#recent-contests",this.recent_contests_view),this.live_contests_view||(this.live_contests_view=new HR.MyRankLiveContestsView({hacker:this.hacker}),this.add_subview(this.live_contests_view)),this.assign("#ongoing-contests",this.live_contests_view),this.upcoming_contests_view||(this.upcoming_contests_view=new HR.MyRankUpcomingContestsView({hacker:this.hacker}),this.add_subview(this.upcoming_contests_view)),this.assign("#upcoming-contests",this.upcoming_contests_view)},MyRankContestsView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankContestsView=MyRankContestsView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankRecentContestsView,ref;return MyRankRecentContestsView=function(superClass){function MyRankRecentContestsView(){return MyRankRecentContestsView.__super__.constructor.apply(this,arguments)}return extend(MyRankRecentContestsView,superClass),MyRankRecentContestsView.prototype.template="my-rank-recent-contests",MyRankRecentContestsView.prototype.className="my-rank-recent-contests-view",MyRankRecentContestsView.prototype.events={"click .table-load-more":"loadMore"},MyRankRecentContestsView.prototype.initialize=function(options){var that;return null==options&&(options={}),this.hacker=options.hacker,this.collection=new HR.MyRankContestsCollection({collection_type:"recent"}),that=this,this.loading=!1,this.collection.fetch({silent:!0,success:function(){return that.render()}})},MyRankRecentContestsView.prototype.render=function(){return this.collection.sync_status?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,collection:this.collection,canLoadMore:this.canLoadMore(),total:this.collection.getTotal()})),this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(32)),this},MyRankRecentContestsView.prototype.canLoadMore=function(){return this.collection.length<this.collection.getTotal()},MyRankRecentContestsView.prototype.loadMore=function(e){var that;return this.loading?void 0:(this.loading=!0,this.collection.increaseOffset(),that=this,$(e.currentTarget).parent().html(HR.appController.viewLoader(32)),this.collection.fetch({remove:!1,silent:!0,success:function(){return that.loading=!1,that.render()}}))},MyRankRecentContestsView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankRecentContestsView=MyRankRecentContestsView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankLiveContestsView,ref;return MyRankLiveContestsView=function(superClass){function MyRankLiveContestsView(){return MyRankLiveContestsView.__super__.constructor.apply(this,arguments)}return extend(MyRankLiveContestsView,superClass),MyRankLiveContestsView.prototype.template="my-rank-live-contests",MyRankLiveContestsView.prototype.className="my-rank-live-contests-view",MyRankLiveContestsView.prototype.initialize=function(options){var that;return null==options&&(options={}),this.hacker=options.hacker,this.collection=new HR.MyRankContestsCollection({collection_type:"ongoing"}),that=this,this.firstLoad=!0,this.collection.fetch({silent:!0,success:function(){return that.render()}})},MyRankLiveContestsView.prototype.render=function(){return this.collection.sync_status?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,collection:this.collection})),this.renderSubviews(),this.firstLoad&&this.scrollToLiveContest(),this.firstLoad=!1,this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(32)),this},MyRankLiveContestsView.prototype.renderSubviews=function(clean_views){return null==clean_views&&(clean_views=!0),clean_views&&this.cleanupSubviews(),this.collection.length>0?_.each(this.collection.models,function(model){var _view;return _view=new HR.MyRankLiveContestView({model:model}),this.$("#live-contests-content").append(_view.render().el),this.add_subview(_view)},this):void 0},MyRankLiveContestsView.prototype.cleanupSubviews=function(){return this._subviews&&_.isArray(this._subviews)?_.each(this._subviews,function(view){return this[view]?(this[view].destroy(),this[view]=void 0):void 0},this):void 0},MyRankLiveContestsView.prototype.scrollToLiveContest=function(){return setTimeout(function(){return function(){return $("html,body").animate({scrollTop:$("#ongoing-contests").offset().top},"slow")}}(this),500)},MyRankLiveContestsView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankLiveContestsView=MyRankLiveContestsView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankLiveContestView,ref;return MyRankLiveContestView=function(superClass){function MyRankLiveContestView(){return MyRankLiveContestView.__super__.constructor.apply(this,arguments)}return extend(MyRankLiveContestView,superClass),MyRankLiveContestView.prototype.template="my-rank-live-contest",MyRankLiveContestView.prototype.className="my-rank-live-contest-view",MyRankLiveContestView.prototype.initialize=function(options){return null==options&&(options={}),this.model=options.model},MyRankLiveContestView.prototype.render=function(){return $(this.el).html(HR.appController.template(this.template,this)({contest:this.model.toJSON(),rank_string:this.rankString()})),this.updateTimer(),this.delegateEvents(),this},MyRankLiveContestView.prototype.updateTimer=function(interval){var time_remaining;return null==interval&&(interval=60),time_remaining=this.model.time_remaining_string(interval),time_remaining?(this.$(".time-remaining").html(time_remaining+" left"),setTimeout(function(_this){return function(){return _this.updateTimer()}}(this),1e3*interval)):void 0},MyRankLiveContestView.prototype.rankString=function(){return this.model.get("rank")?HR.util.toOrdinal(this.model.get("rank"))+" out of "+this.model.get("cached_leaderboard_total"):"<a class='backbone' href='/contests/"+this.model.get("slug")+"/challenges'\ndata-analytics='MyRankLiveContestSubmitLink' data-attr1='"+this.model.get("slug")+"'>\nSubmit</a> your first challenge to find your rank."},MyRankLiveContestView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankLiveContestView=MyRankLiveContestView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankUpcomingContestsView,ref;return MyRankUpcomingContestsView=function(superClass){function MyRankUpcomingContestsView(){return MyRankUpcomingContestsView.__super__.constructor.apply(this,arguments)}return extend(MyRankUpcomingContestsView,superClass),MyRankUpcomingContestsView.prototype.template="my-rank-upcoming-contests",MyRankUpcomingContestsView.prototype.className="my-rank-upcoming-contests-view",MyRankUpcomingContestsView.prototype.events={"click .table-load-more":"loadMore"},MyRankUpcomingContestsView.prototype.initialize=function(options){var that;return null==options&&(options={}),this.hacker=options.hacker,this.collection=new HR.MyRankContestsCollection({collection_type:"upcoming"}),that=this,this.loading=!1,this.collection.fetch({silent:!0,success:function(){return that.render()}})},MyRankUpcomingContestsView.prototype.render=function(){return this.collection.sync_status?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,collection:this.collection,canLoadMore:this.canLoadMore(),total:this.collection.getTotal()})),this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(32)),this},MyRankUpcomingContestsView.prototype.canLoadMore=function(){return this.collection.length<this.collection.getTotal()},MyRankUpcomingContestsView.prototype.loadMore=function(e){var that;return this.loading?void 0:(this.loading=!0,this.collection.increaseOffset(),that=this,$(e.currentTarget).parent().html(HR.appController.viewLoader(32)),this.collection.fetch({remove:!1,silent:!0,success:function(){return that.loading=!1,that.render()}}))},MyRankUpcomingContestsView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankUpcomingContestsView=MyRankUpcomingContestsView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankDomainsBadgesView,ref;return MyRankDomainsBadgesView=function(superClass){function MyRankDomainsBadgesView(){return MyRankDomainsBadgesView.__super__.constructor.apply(this,arguments)}return extend(MyRankDomainsBadgesView,superClass),MyRankDomainsBadgesView.prototype.template="my-rank-domains-badges",MyRankDomainsBadgesView.prototype.className="my-rank-domains-badges-view",MyRankDomainsBadgesView.prototype.initialize=function(options){var that;return null==options&&(options={}),this.hacker=options.hacker,this.collection=new HR.MyRankBadgesCollection,that=this,this.collection.fetch({silent:!0,success:function(){return that.render()}})},MyRankDomainsBadgesView.prototype.render=function(){return this.collection.sync_status?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,models:this.collection.toJSON(),star_positions:this.starPositions()})),this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(32))},MyRankDomainsBadgesView.prototype.starPositions=function(){return[28.5,40.5,52.5,64.5]},MyRankDomainsBadgesView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankDomainsBadgesView=MyRankDomainsBadgesView})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var HR,MyRankDomainsRecentActivityView,ref;return MyRankDomainsRecentActivityView=function(superClass){function MyRankDomainsRecentActivityView(){return MyRankDomainsRecentActivityView.__super__.constructor.apply(this,arguments)}return extend(MyRankDomainsRecentActivityView,superClass),MyRankDomainsRecentActivityView.prototype.template="my-rank-domains-recent-activity",MyRankDomainsRecentActivityView.prototype.className="my-rank-domains-recent-activity-view",MyRankDomainsRecentActivityView.prototype.events={"click .table-load-more":"loadMore"},MyRankDomainsRecentActivityView.prototype.initialize=function(options){var that;return null==options&&(options={}),this.hacker=options.hacker,this.collection=new HR.MyRankRecentActivityCollection,that=this,this.loading=!1,this.collection.fetch({silent:!0,success:function(){return that.render()}})},MyRankDomainsRecentActivityView.prototype.render=function(){return this.collection.sync_status?($(this.el).html(HR.appController.template(this.template,this)({hacker:this.hacker,models:this.collection.toJSON(),canLoadMore:this.canLoadMore(),total:this.collection.getTotal()})),this.delegateEvents()):$(this.el).html(HR.appController.viewLoader(32))},MyRankDomainsRecentActivityView.prototype.canLoadMore=function(){return this.collection.length<this.collection.getTotal()},MyRankDomainsRecentActivityView.prototype.loadMore=function(e){var that;return this.loading?void 0:(this.loading=!0,this.collection.increaseOffset(),that=this,$(e.currentTarget).parent().html(HR.appController.viewLoader(32)),this.collection.fetch({remove:!1,silent:!0,success:function(){return that.loading=!1,that.render()}}))},MyRankDomainsRecentActivityView}(window.HR.GenericView),HR=null!=(ref=window.HR)?ref:{},HR.MyRankDomainsRecentActivityView=MyRankDomainsRecentActivityView})}.call(this);